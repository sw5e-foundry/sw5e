<div class="panel">
    <ul class="filter-list" data-filter="features">
        <li class="filter-title">{{localize "SW5E.Filter"}}</li>
        <li class="filter-item" data-filter="action">{{localize "SW5E.Action"}}</li>
        <li class="filter-item" data-filter="bonus">{{localize "SW5E.BonusAction"}}</li>
        <li class="filter-item" data-filter="reaction">{{localize "SW5E.Reaction"}}</li>
        <li class="filter-item" data-filter="activeDeploy">{{localize "SW5E.FilterActiveDeploy"}}</li>
    </ul>

    <ol class="group-list">
        {{#each config.deploymentTypes as | name key |}}
            <li>
                {{#with (lookup @root.data.attributes.deployment key) as | deployment |}}
                    {{#if (or (and deployment.items deployment.items.length) deployment.uuid @root.showAllDeployments)}}
                        <div class="group-list-title">
                            <h3 class="item-name">
                            {{#if (lookup @root.data.attributes.deployment key)}}
                                {{#with (lookup @root.data.attributes.deployment key) as | deployment |}}
                                    {{#if deployment.items}}
                                        {{localize (lookup @root.config.deploymentTypesPlural key)}}
                                    {{else}}
                                        {{localize name}}
                                    {{/if}}
                                {{/with}}
                            {{else}}
                                {{localize (lookup @root.config.deploymentTypesPlural key)}}
                            {{/if}}
                            </h3>
                        </div>
                        <ol class="group-items item-list">
                            {{#if deployment.items}}
                                {{#each deployment.items as | deploy |}}
                                    <li class="item group-grid-deployments {{#if deploy.active}}active-deployment{{/if}}" data-key="{{key}}" data-uuid="{{deploy.uuid}}">
                                        <div class="group-item-title">
                                            <h4>{{ contentLink deploy.uuid }}</h4>
                                        </div>
                                        <div class="item-detail item-controls">
                                            {{#if (and @root.owner deploy.uuid)}}
                                                <a class="deploy-control" data-action="toggle" title="{{localize 'SW5E.DeployToggle'}}">
                                                    <i class="fas {{#if deploy.active}}fa-check{{else}}fa-times{{/if}}"></i>
                                                </a>
                                                <a class="deploy-control" data-action="delete" title="{{localize 'SW5E.DeployDelete'}}">
                                                    <i class="fas fa-trash"></i>
                                                </a>
                                            {{/if}}
                                        </div>
                                    </li>
                                {{/each}}
                            {{else}}
                                <li class="item group-grid-deployments {{#if deployment.active}}active-deployment{{/if}}" data-key="{{key}}" data-uuid="{{deployment.uuid}}">
                                    <div class="group-item-title">
                                        <h4>{{ contentLink deployment.uuid }}</h4>
                                    </div>

                                    <div class="item-detail item-controls">
                                        {{#if (and @root.owner deployment.uuid)}}
                                            <a class="deploy-control" data-action="toggle" title="{{localize 'SW5E.DeployToggle'}}">
                                                <i class="fas {{#if deployment.active}}fa-check{{else}}fa-times{{/if}}"></i>
                                            </a>
                                            <a class="deploy-control" data-action="delete" title="{{localize 'SW5E.DeployDelete'}}">
                                                <i class="fas fa-trash"></i>
                                            </a>
                                        {{/if}}
                                    </div>
                                </li>
                            {{/if}}
                        </ol>
                        {{#with (lookup @root.starshipactions key) as | actions |}}
                            {{#if (and (or deployment.active @root.showAllActions) (not (eq actions.items.length 0)))}}
                                {{> 'systems/sw5e/templates/actors/newActor/parts/swalt-crewactions.html' actions=actions owner=../../../owner name=name}}
                            {{/if}}
                        {{/with}}
                    {{/if}}
                {{/with}}
            </li>
        {{/each}}
    </ol>
</div>
